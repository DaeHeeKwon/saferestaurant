{% extends 'base.html' %}

{% block title %}
    <title>Safe Restaurant List</title>
{% endblock title %}


{% block main_content %}

    <div class="card border border-secondary">
                                        
        <div class="card-body">
            <form class="form-header" action="." method="POST">
                <input class="au-input au-input--xl" type="text" id="region" placeholder="시/도 또는 구까지의 정보를 입력하세요" />
                <button class="au-btn--submit" type="button" id="btn_search">
                    <i class="zmdi zmdi-search"></i>
                </button>
            </form>
            <br>
            <div class="table-responsive m-b-30" style="font-size: 8pt;">
                <table id="sr_table" class="table table-borderless table-striped table-earning">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>음식점 이름</th>
                            <th>주소</th>
                            <th>전화번호</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

{% endblock main_content %}

{% block custom_js %}
<script type="text/javascript">

$(function(){
    $('#btn_search').on('click',function(event){

        var region = $('#region').val();
        if(!region){
            return;
        }

        $('#sr_table tbody').empty();

        $.ajax({
            "url": "/saferestaurantinfo/saferestaurantlist/" + region,
            "method": "GET",
            "dataType":"json",
            "success": function(data, status, xhr){
                for(var i=0; i<data.length; i++){
                    var tr = $('<tr></tr>');
                    $('<td></td>').text(data[i][0]).appendTo(tr); // No
                    $('<td></td>').text(data[i][2]).appendTo(tr); // 음식점 이름
                    $('<td></td>').text(data[i][4]).appendTo(tr); // 주소
                    $('<td></td>').text(data[i][6]).appendTo(tr); // 전화번호
                    $('#sr_table tbody').append(tr);
                };
            },
            "error": function(xhr, status, err){
                alert("err");
            }
        })
    });
});
</script>
{% endblock custom_js %}